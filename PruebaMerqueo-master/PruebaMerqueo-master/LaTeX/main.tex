\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{minted}
\usepackage{listings, xcolor}

\title{Desarrollo Prueba Backend (Merqueo) }
\author{Kevin Andrey Herrera Silva}
\date{2019-07-30}

\usepackage{natbib}
\usepackage{graphicx}

\begin{document}

\maketitle

\section{Introducción}
Para el desarrollo de esta prueba se utilizó el lenguaje de programación \textbf{NODE JS} haciendo uso del framework \textbf{ADONIS JS} con el que se realizaron todas las actividades requeridas, posteriormente se dockerizo la aplicación para que pueda ser ejecutada en cualquier equipo.

\section{Plantear bases de datos}
Para comenzar con el desarrollo lo que se hizo fue plantear una base de datos relacional SQL utilizando el motor de base de datos \textbf{Sqlite} para entorno de desarrollo y \textbf{MySQL} en un servidor remoto para etapa de producción.\\
El modelo relacional quedó de la siguiente forma:

\begin{figure}[h!]
\centering
\includegraphics[scale=0.6]{BD.png}
\end{figure}

\section{Poblar bases de datos}
Posteriormente se procede a poblar la base de datos con el contenido de los 3 archivos JSON que fueron propuestos (Ordes, Inventory y Providers). Para esto se decidió plantear 3 servicios en el controlador PopulateController que se encargan de recibir cada JSON y sacar todos sus datos para persistirlos en la tabla correspondiente (Se encontró un error en el id de los proveedores ya que todos tenían exactamente el mismo, por lo que se corrigió dejando un consecutivo para cada uno).
\\\\
\textbf{Poblar Inventario}
\begin{figure}[h!]
\centering
\includegraphics[scale=0.4]{Pinv.png}
\end{figure}
\\
\textbf{Poblar Proveedores}
\begin{figure}[h!]
\centering
\includegraphics[scale=0.4]{Pprov.png}
\end{figure}
\\\\\\\\\\
\textbf{Poblar Ordenes}
\begin{figure}[h!]
\centering
\includegraphics[scale=0.4]{Pord.png}
\end{figure}
\section{Consultar qué productos y qué cantidad puede ser alistada desde el inventario}
\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{1.png}
\end{figure}
\clearpage
\begin{minted}{json}
{
    "status": 200,
    "message": "Consultar qué productos y qué cantidad puede ser alistada desde
    el inventario",
    "data": [
        {
            "product_id": 1,
            "name": "Leche",
            "require": 1,
            "in_stock": 3,
            "available": true
        },
        {
            "product_id": 2,
            "name": "Huevos",
            "require": 21,
            "in_stock": 3,
            "available": false,
            "missing": 18
        },
        {
            "product_id": 3,
            "name": "Manzana Verde",
            "require": 10,
            "in_stock": 7,
            "available": false,
            "missing": 3
        },
        {
            "product_id": 4,
            "name": "Pepino Cohombro",
            "require": 7,
            "in_stock": 8,
            "available": true
        },
        {
            "product_id": 5,
            "name": "Pimentón Rojo",
            "require": 102,
            "in_stock": 10,
            "available": false,
            "missing": 92
        },
        {
            "product_id": 6,
            "name": "Kiwi",
            "require": 60,
            "in_stock": 15,
            "available": false,
            "missing": 45
        },
        {
            "product_id": 12,
            "name": "Aguacate Maduro",
            "require": 4,
            "in_stock": 8,
            "available": true
        },
        {
            "product_id": 13,
            "name": "Kale o Col Rizada",
            "require": 2,
            "in_stock": 2,
            "available": true
        },
        {
            "product_id": 14,
            "name": "Cebolla Cabezona Roja Limpia",
            "require": 4,
            "in_stock": 1,
            "available": false,
            "missing": 3
        },
        {
            "product_id": 15,
            "name": "Tomate Chonto Maduro",
            "require": 5,
            "in_stock": 1,
            "available": false,
            "missing": 4
        },
        {
            "product_id": 16,
            "name": "Acelga",
            "require": 1503,
            "in_stock": 9,
            "available": false,
            "missing": 1494
        },
        {
            "product_id": 22,
            "name": "Cebolla Larga Junca x 500grs",
            "require": 7,
            "in_stock": 6,
            "available": false,
            "missing": 1
        },
        {
            "product_id": 7,
            "name": "Cebolla Cabezona Blanca Limpia",
            "require": 6,
            "in_stock": 26,
            "available": true
        },
        {
            "product_id": 17,
            "name": "Espinaca Bogotana x 500grs",
            "require": 3,
            "in_stock": 17,
            "available": true
        },
        {
            "product_id": 18,
            "name": "Ahuyama",
            "require": 3,
            "in_stock": 8,
            "available": true
        },
        {
            "product_id": 19,
            "name": "Cebolla Cabezona Blanca Sin Pelar",
            "require": 8,
            "in_stock": 9,
            "available": true
        },
        {
            "product_id": 20,
            "name": "Melón",
            "require": 3,
            "in_stock": 9,
            "available": true
        },
        {
            "product_id": 21,
            "name": "Cebolla Cabezona Roja Sin Pelar",
            "require": 3,
            "in_stock": 3,
            "available": true
        },
        {
            "product_id": 23,
            "name": "Hierbabuena x 500grs",
            "require": 2,
            "in_stock": 9,
            "available": true
        },
        {
            "product_id": 24,
            "name": "Lechuga Crespa Verde",
            "require": 15,
            "in_stock": 9,
            "available": false,
            "missing": 6
        },
        {
            "product_id": 25,
            "name": "Limón Tahití",
            "require": 5,
            "in_stock": 10,
            "available": true
        },
        {
            "product_id": 31,
            "name": "Papa R-12 Mediana",
            "require": 25,
            "in_stock": 9,
            "available": false,
            "missing": 16
        },
        {
            "product_id": 8,
            "name": "Habichuela",
            "require": 3,
            "in_stock": 11,
            "available": true
        },
        {
            "product_id": 9,
            "name": "Mango Tommy Maduro",
            "require": 4,
            "in_stock": 1,
            "available": false,
            "missing": 3
        },
        {
            "product_id": 10,
            "name": "Tomate Chonto Pintón",
            "require": 8,
            "in_stock": 8,
            "available": true
        },
        {
            "product_id": 11,
            "name": "Zanahoria Grande",
            "require": 5,
            "in_stock": 7,
            "available": true
        },
        {
            "product_id": 30,
            "name": "Fresa Jugo",
            "require": 2,
            "in_stock": 1,
            "available": false,
            "missing": 1
        },
        {
            "product_id": 32,
            "name": "Curuba ",
            "require": 1,
            "in_stock": 10,
            "available": true
        },
        {
            "product_id": 33,
            "name": "Brócoli",
            "require": 1,
            "in_stock": 2,
            "available": true
        },
        {
            "product_id": 28,
            "name": "Tomate Larga Vida Maduro",
            "require": 3,
            "in_stock": 3,
            "available": true
        },
        {
            "product_id": 26,
            "name": "Mora de Castilla",
            "require": 2,
            "in_stock": 40,
            "available": true
        },
        {
            "product_id": 27,
            "name": "Pimentón Verde",
            "require": 1,
            "in_stock": 2,
            "available": true
        },
        {
            "product_id": 34,
            "name": "Aguacate Hass Pintón",
            "require": 3,
            "in_stock": 3,
            "available": true
        },
        {
            "product_id": 35,
            "name": "Aguacate Hass Maduro ",
            "require": 3,
            "in_stock": 3,
            "available": true
        },
        {
            "product_id": 36,
            "name": "Aguacate Pintón",
            "require": 1,
            "in_stock": 6,
            "available": true
        },
        {
            "product_id": 29,
            "name": "Cilantro x 500grs",
            "require": 1,
            "in_stock": 2,
            "available": true
        }
    ]
}
\end{minted}
\clearpage
\section{Consultar los productos que deben ser alistados por proveedores y a qué proveedor le corresponde cada pedido.}
\\

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{2.png}
\end{figure}

\\
\begin{minted}{json}
{
    "status": 200,
    "message": "Consultar los productos que deben ser alistados por proveedores y a qué proveedor le corresponde cada pedido.",
    "order_list": [
        {
            "id": 1,
            "data": [
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 2,
                    "product_name": "Huevos",
                    "quantity": 18
                },
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 3,
                    "product_name": "Manzana Verde",
                    "quantity": 3
                }
            ]
        },
        {
            "id": 2,
            "data": [
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 5,
                    "product_name": "Pimentón Rojo",
                    "quantity": 92
                },
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 6,
                    "product_name": "Kiwi",
                    "quantity": 45
                }
            ]
        },
        {
            "id": 4,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 14,
                    "product_name": "Cebolla Cabezona Roja Limpia",
                    "quantity": 3
                },
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 15,
                    "product_name": "Tomate Chonto Maduro",
                    "quantity": 4
                }
            ]
        },
        {
            "id": 5,
            "data": [
                {
                    "provider_id": 2,
                    "provider_name": "Raul",
                    "product_id": 16,
                    "product_name": "Acelga",
                    "quantity": 1494
                }
            ]
        },
        {
            "id": 9,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 22,
                    "product_name": "Cebolla Larga Junca x 500grs",
                    "quantity": 1
                }
            ]
        },
        {
            "id": 6,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 15,
                    "product_name": "Tomate Chonto Maduro",
                    "quantity": 4
                }
            ]
        },
        {
            "id": 7,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 22,
                    "product_name": "Cebolla Larga Junca x 500grs",
                    "quantity": 1
                },
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 24,
                    "product_name": "Lechuga Crespa Verde",
                    "quantity": 6
                }
            ]
        },
        {
            "id": 12,
            "data": [
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 5,
                    "product_name": "Pimentón Rojo",
                    "quantity": 92
                },
                {
                    "provider_id": 2,
                    "provider_name": "Raul",
                    "product_id": 31,
                    "product_name": "Papa R-12 Mediana",
                    "quantity": 16
                }
            ]
        },
        {
            "id": 3,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 9,
                    "product_name": "Mango Tommy Maduro",
                    "quantity": 3
                }
            ]
        },
        {
            "id": 13,
            "data": [
                {
                    "provider_id": 2,
                    "provider_name": "Raul",
                    "product_id": 30,
                    "product_name": "Fresa Jugo",
                    "quantity": 1
                }
            ]
        },
        {
            "id": 8,
            "data": [
                {
                    "provider_id": 3,
                    "provider_name": "Angelica",
                    "product_id": 22,
                    "product_name": "Cebolla Larga Junca x 500grs",
                    "quantity": 1
                },
                {
                    "provider_id": 1,
                    "provider_name": "Ruby",
                    "product_id": 5,
                    "product_name": "Pimentón Rojo",
                    "quantity": 92
                }
            ]
        },
        {
            "id": 14,
            "data": [
                {
                    "provider_id": 2,
                    "provider_name": "Raul",
                    "product_id": 16,
                    "product_name": "Acelga",
                    "quantity": 1494
                }
            ]
        },
        {
            "id": 11,
            "data": [
                {
                    "provider_id": 2,
                    "provider_name": "Raul",
                    "product_id": 30,
                    "product_name": "Fresa Jugo",
                    "quantity": 1
                }
            ]
        }
    ]
\end{minted}
\clearpage
\section{Productos menos vendidos el día 1 de marzo.}
\\

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{3.png}
\end{figure}

\\
\begin{minted}{json}
{
    "status": 200,
    "message": "Productos menos vendidos el día 1 de marzo.",
    "data": [
        {
            "product_id": 1,
            "name": "Leche",
            "quantity": 1
        },
        {
            "product_id": 43,
            "name": "Banano",
            "quantity": 1
        },
        {
            "product_id": 32,
            "name": "Curuba ",
            "quantity": 1
        }
    ]
}
\end{minted}
\clearpage
\section{Dado el Id de un pedido, saber qué productos y qué cantidad pueden ser alistados según sistema de inventario y cuáles deben ser abastecidos por los proveedores.}
\\

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{4.png}
\end{figure}

\\
\begin{minted}{json}
{
    "status": 200,
    "message": "Dado el Id de un pedido, saber qué productos y qué cantidad 
    pueden ser alistados según sistema de inventario y cuáles deben ser
    abastecidos por los proveedores.",
    "data": {
        "inventory": [
            {
                "product_id": 1,
                "name": "Leche",
                "quantity": 1
            },
            {
                "product_id": 2,
                "name": "Huevos",
                "quantity": 3
            },
            {
                "product_id": 3,
                "name": "Manzana Verde",
                "quantity": 7
            },
            {
                "product_id": 4,
                "name": "Pepino Cohombro",
                "quantity": 5
            }
        ],
        "providers": [
            {
                "product_id": 2,
                "name": "Huevos",
                "quantity": 18
            },
            {
                "product_id": 37,
                "name": "Pan Bimbo",
                "quantity": 7
            },
            {
                "product_id": 3,
                "name": "Manzana Verde",
                "quantity": 3
            }
        ]
    }
}
\end{minted}
\clearpage
\section{Calcular el inventario del día 2 de marzo, teniendo en cuenta los pedidos despachados el 1 de marzo.}
\\

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{5.png}
\end{figure}

\\
\begin{minted}{json}
{
    "status": 200,
    "message": "Calcular el inventario del día 2 de marzo, teniendo en cuenta los
    pedidos despachados el 1 de marzo.",
    "data": {
        "inventory": [
            {
                "quantity": 2,
                "date": "2019-03-02",
                "id": 1
            },
            {
                "quantity": 1,
                "date": "2019-03-02",
                "id": 4
            },
            {
                "quantity": 20,
                "date": "2019-03-02",
                "id": 7
            },
            {
                "quantity": 8,
                "date": "2019-03-02",
                "id": 8
            },
            {
                "quantity": 2,
                "date": "2019-03-02",
                "id": 11
            },
            {
                "quantity": 4,
                "date": "2019-03-02",
                "id": 12
            },
            {
                "quantity": 14,
                "date": "2019-03-02",
                "id": 17
            },
            {
                "quantity": 5,
                "date": "2019-03-02",
                "id": 18
            },
            {
                "quantity": 1,
                "date": "2019-03-02",
                "id": 19
            },
            {
                "quantity": 6,
                "date": "2019-03-02",
                "id": 20
            },
            {
                "quantity": 7,
                "date": "2019-03-02",
                "id": 23
            },
            {
                "quantity": 5,
                "date": "2019-03-02",
                "id": 25
            },
            {
                "quantity": 38,
                "date": "2019-03-02",
                "id": 26
            },
            {
                "quantity": 1,
                "date": "2019-03-02",
                "id": 27
            },
            {
                "quantity": 1,
                "date": "2019-03-02",
                "id": 29
            },
            {
                "quantity": 9,
                "date": "2019-03-02",
                "id": 32
            },
            {
                "quantity": 1,
                "date": "2019-03-02",
                "id": 33
            },
            {
                "quantity": 5,
                "date": "2019-03-02",
                "id": 36
            }
        ]
    }
}
\end{minted}
\clearpage
\section{Productos más vendidos el día 1 de marzo.}
\\

\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{6.png}
\end{figure}

\\
\begin{minted}{json}
{
    "status": 200,
    "message": "Productos más vendidos el día 1 de marzo.",
    "data": [
        {
            "product_id": 16,
            "name": "Acelga",
            "quantity": 1500
        },
        {
            "product_id": 5,
            "name": "Pimentón Rojo",
            "quantity": 102
        },
        {
            "product_id": 6,
            "name": "Kiwi",
            "quantity": 60
        }
    ]
}
\end{minted}
\clearpage
\section{Pruebas}
Se realizaron las respectivas pruebas unitarias para comprobar el correcto funcionamiento del sistema obteniendo el siguiente resultado:

\begin{figure}[h!]
\centering
\includegraphics[scale=1]{test.png}
\end{figure}

\section{Dockerización}
Para terminar y garantizar que cualquier persona pueda facilmente probar el proyecto sin necesidad de instalar software o dependencias se decidió realizar la dockerización del mismo. Así el proyecto puede ser ejecutado en cualquier maquina con unos pocos comandos (El servicio quedará expuesto en el puerto 8080)

\section{Descripción de arquitectura utilizada}

Se optó por desarrollar el proyecto utilizando el estilo de arquitectura MVC (Model Vista Controlador) por su afinidad con el framework utilizado (Adonis JS) y por ser una con las que personalmente me siento más comodo.
\\
Se realizó el uso de un ORM llamado Lucid para la gestión de Modelos y base de datos.
\\\\
El proyecto está conformado por 5 Modelos y 6 controladores:\\
\\
Lista de Modelos\\

\textbf{Inventory}

\textbf{Order}

\textbf{OrdersProducts}

\textbf{Product}

\textbf{Provider}
\\\\
Lista de Controladores\\

\textbf{ListingController:} Encargado de listar productos en base al ID de una orden y revisar cuales pueden ser alistados desde el inventario y cuales deben ser por proveedores.

\textbf{NewInventoryController:} Encargado de calcular el nuevo inventario a partir de las ordenes realizadas en un día.

\textbf{PopulareController:} Encargado de poblar las bases de datos con los JSONS entregados.

\textbf{ProductsFromInventoryController:} Encargado de consultar que productos pueden ser alistados desde el inventario.

\textbf{ProductsFromProvidersController:} Encargado de consultar que productos deben ser alistados por proveedores externos.

\textbf{SaleController:} Encargado de calcular un informe de ventas y retornar productos más vendidos y menos vendidos.
\\\\\\\\\\\\\\\\\\\\\\\\\\
\textit{\textbf{Documento escrito usando LaTeX}}
\end{document}